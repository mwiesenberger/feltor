<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Extension: Matrix functions: dg::mat::UniversalLanczos&lt; ContainerType &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
    <!-- ... doxygen-awesome Fragment copy ... -->
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeFragmentCopyButton.init()
    </script>
    <!-- ... End doxygen-awesome Fragment copy ... -->
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-fragment-copy-button.js" rel="stylesheet" type="text/css"/>
<link href="menubar.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Make a nice link to github (copied from doxygen-awesome/doxygen-custom/header.html-->
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/feltor-dev/feltor" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="80" height="80" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<!-- End Make a nice link to github -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
    <!--My own title area-->
  <ul class="menubar">
      <!-- <li><a href="../../../index.html">/</a><li>-->
    <li><a href="../../dg/html/topics.html">dg</a></li>
    <li><a href="../../geometries/html/topics.html">dg::geo</a></li>
    <li><a href="../../file/html/topics.html">dg::file</a></li>
    <li><a href="../../exblas/html/namespacedg_1_1exblas.html">dg::exblas</a></li>
    <li><a href="../../matrix/html/topics.html">dg::mat</a></li>
  </ul>
  <!--End My own title area-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Extension: Matrix functions
   </div>
   <div id="projectbrief">#include &quot;dg/matrix/matrix.h&quot;</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classdg_1_1mat_1_1_universal_lanczos.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classdg_1_1mat_1_1_universal_lanczos-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">dg::mat::UniversalLanczos&lt; ContainerType &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__matrixnumerical0.html">Level 2: Basic numerical algorithms</a> &raquo; <a class="el" href="group__matrixfunctionapproximation.html">Matrix-functions</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Tridiagonalize \(A\) and approximate \(f(A)b \approx |b|_W V f(T) e_1\) via Lanczos algorithm. A is self-adjoint in the weights \( W\).  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a370305216d927c1cbffcfe8fe58ae685" id="r_a370305216d927c1cbffcfe8fe58ae685"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> = <a class="elRef" href="../../dg/html/group__dispatch.html#gafb37680870fa007f5c17589781880e92">get_value_type</a>&lt;ContainerType&gt;</td></tr>
<tr class="separator:a370305216d927c1cbffcfe8fe58ae685"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa044680e0ff1a7be7528235965c58363" id="r_aa044680e0ff1a7be7528235965c58363"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa044680e0ff1a7be7528235965c58363">UniversalLanczos</a> ()</td></tr>
<tr class="memdesc:aa044680e0ff1a7be7528235965c58363"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate nothing, Call <code>construct</code> method before usage.  <br /></td></tr>
<tr class="separator:aa044680e0ff1a7be7528235965c58363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75567bfd54a7f388d3abe111ea25554c" id="r_a75567bfd54a7f388d3abe111ea25554c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75567bfd54a7f388d3abe111ea25554c">UniversalLanczos</a> (const ContainerType &amp;copyable, unsigned max_iterations)</td></tr>
<tr class="memdesc:a75567bfd54a7f388d3abe111ea25554c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for the method.  <br /></td></tr>
<tr class="separator:a75567bfd54a7f388d3abe111ea25554c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb5ed88c774c43d92c8c9a42cf9a755e" id="r_aeb5ed88c774c43d92c8c9a42cf9a755e"><td class="memTemplParams" colspan="2">template&lt;class ... Params&gt; </td></tr>
<tr class="memitem:aeb5ed88c774c43d92c8c9a42cf9a755e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aeb5ed88c774c43d92c8c9a42cf9a755e">construct</a> (Params &amp;&amp;...ps)</td></tr>
<tr class="memdesc:aeb5ed88c774c43d92c8c9a42cf9a755e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perfect forward parameters to one of the constructors.     <br /></td></tr>
<tr class="separator:aeb5ed88c774c43d92c8c9a42cf9a755e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad367aeffd08562f5e557b633f51e7339" id="r_ad367aeffd08562f5e557b633f51e7339"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad367aeffd08562f5e557b633f51e7339">set_max</a> (unsigned new_max)</td></tr>
<tr class="memdesc:ad367aeffd08562f5e557b633f51e7339"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the maximum number of iterations.  <br /></td></tr>
<tr class="separator:ad367aeffd08562f5e557b633f51e7339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c3263e23586f66cb758f8bbc94c3e44" id="r_a8c3263e23586f66cb758f8bbc94c3e44"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c3263e23586f66cb758f8bbc94c3e44">get_max</a> () const</td></tr>
<tr class="memdesc:a8c3263e23586f66cb758f8bbc94c3e44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current maximum number of iterations.  <br /></td></tr>
<tr class="separator:a8c3263e23586f66cb758f8bbc94c3e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4938f6a1f1d7a73852f7ba46a7dba8" id="r_a7a4938f6a1f1d7a73852f7ba46a7dba8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a4938f6a1f1d7a73852f7ba46a7dba8">set_verbose</a> (bool verbose)</td></tr>
<tr class="memdesc:a7a4938f6a1f1d7a73852f7ba46a7dba8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set or unset debugging output during iterations.  <br /></td></tr>
<tr class="separator:a7a4938f6a1f1d7a73852f7ba46a7dba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a2911d91ba236e25a10c9e01dff5bc1" id="r_a2a2911d91ba236e25a10c9e01dff5bc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a2911d91ba236e25a10c9e01dff5bc1">get_bnorm</a> () const</td></tr>
<tr class="memdesc:a2a2911d91ba236e25a10c9e01dff5bc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Norm of <code>b</code> from last call to <code>operator()</code>  <br /></td></tr>
<tr class="separator:a2a2911d91ba236e25a10c9e01dff5bc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9911ecaf6fd13d1d4b7bcdf1691af335" id="r_a9911ecaf6fd13d1d4b7bcdf1691af335"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9911ecaf6fd13d1d4b7bcdf1691af335">get_iter</a> () const</td></tr>
<tr class="memdesc:a9911ecaf6fd13d1d4b7bcdf1691af335"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of iterations in the last call to <code>tridiag</code> or <code>solve</code> (same as T.num_rows)  <br /></td></tr>
<tr class="separator:a9911ecaf6fd13d1d4b7bcdf1691af335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac8263710136f1baa907c32179d2ad60" id="r_aac8263710136f1baa907c32179d2ad60"><td class="memTemplParams" colspan="2">template&lt;class MatrixType , class ContainerType0 , class ContainerType1 , class ContainerType2 , class FuncTe1 &gt; </td></tr>
<tr class="memitem:aac8263710136f1baa907c32179d2ad60"><td class="memTemplItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aac8263710136f1baa907c32179d2ad60">solve</a> (ContainerType0 &amp;x, FuncTe1 f, MatrixType &amp;&amp;A, const ContainerType1 &amp;b, const ContainerType2 &amp;weights, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> eps, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> nrmb_correction=1., std::string error_norm=&quot;universal&quot;, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> res_fac=1., unsigned q=1)</td></tr>
<tr class="memdesc:aac8263710136f1baa907c32179d2ad60"><td class="mdescLeft">&#160;</td><td class="mdescRight">\( x = f(A)b \approx ||b||_W V f(T) e_1 \) via Lanczos and matrix function computation. A is self-adjoint in the weights \( W\).  <br /></td></tr>
<tr class="separator:aac8263710136f1baa907c32179d2ad60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542904b98f6391e9c9d8aeed4d624047" id="r_a542904b98f6391e9c9d8aeed4d624047"><td class="memTemplParams" colspan="2">template&lt;class MatrixType , class ContainerType0 , class ContainerType1 &gt; </td></tr>
<tr class="memitem:a542904b98f6391e9c9d8aeed4d624047"><td class="memTemplItemLeft" align="right" valign="top">const <a class="elRef" href="../../dg/html/structdg_1_1_tri_diagonal.html">dg::TriDiagonal</a>&lt; thrust::host_vector&lt; <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> &gt; &gt; &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a542904b98f6391e9c9d8aeed4d624047">tridiag</a> (MatrixType &amp;&amp;A, const ContainerType0 &amp;b, const ContainerType1 &amp;weights, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> eps=1e-12, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> nrmb_correction=1., std::string error_norm=&quot;universal&quot;, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> res_fac=1., unsigned q=1)</td></tr>
<tr class="separator:a542904b98f6391e9c9d8aeed4d624047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eec63212c438fbd0f3187a934c7948c" id="r_a5eec63212c438fbd0f3187a934c7948c"><td class="memTemplParams" colspan="2">template&lt;class MatrixType , class ContainerType0 , class ContainerType1 , class ContainerType2 &gt; </td></tr>
<tr class="memitem:a5eec63212c438fbd0f3187a934c7948c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a5eec63212c438fbd0f3187a934c7948c">normMbVy</a> (MatrixType &amp;&amp;A, const <a class="elRef" href="../../dg/html/structdg_1_1_tri_diagonal.html">dg::TriDiagonal</a>&lt; thrust::host_vector&lt; <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> &gt; &gt; &amp;T, const ContainerType0 &amp;<a class="elRef" href="../../dg/html/group__creation.html#gace76090e6c95d39b59a1dee2db968d14a415290769594460e2e485922904f345d">y</a>, ContainerType1 &amp;x, const ContainerType2 &amp;b, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> bnorm)</td></tr>
<tr class="memdesc:a5eec63212c438fbd0f3187a934c7948c"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute \( x = |b|_W V y \) from a given tridiagonal matrix T and in-place re-computation of V  <br /></td></tr>
<tr class="separator:a5eec63212c438fbd0f3187a934c7948c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a361b5dcad0b7e2f96b408be1eaa5499b" id="r_a361b5dcad0b7e2f96b408be1eaa5499b"><td class="memTemplParams" colspan="2">template&lt;class UnaryOp , class MatrixType , class ContainerType1 , class ContainerType2 &gt; </td></tr>
<tr class="memitem:a361b5dcad0b7e2f96b408be1eaa5499b"><td class="memTemplItemLeft" align="right" valign="top">const <a class="elRef" href="../../dg/html/structdg_1_1_tri_diagonal.html">dg::TriDiagonal</a>&lt; thrust::host_vector&lt; <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> &gt; &gt; &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a361b5dcad0b7e2f96b408be1eaa5499b">tridiag</a> (UnaryOp f, MatrixType &amp;&amp;A, const ContainerType1 &amp;b, const ContainerType2 &amp;weights, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> eps, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> nrmb_correction, std::string error_norm=&quot;residual&quot;, <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> res_fac=1., unsigned q=1)</td></tr>
<tr class="memdesc:a361b5dcad0b7e2f96b408be1eaa5499b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tridiagonalization of A using Lanczos method.  <br /></td></tr>
<tr class="separator:a361b5dcad0b7e2f96b408be1eaa5499b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;class ContainerType&gt;<br />
class dg::mat::UniversalLanczos&lt; ContainerType &gt;</div><p>Tridiagonalize \(A\) and approximate \(f(A)b \approx |b|_W V f(T) e_1\) via Lanczos algorithm. A is self-adjoint in the weights \( W\). </p>
<p>The M-Lanczos method is based on the paper <a href="https://doi.org/10.1137/100800634">Novel Numerical Methods for Solving the Time-Space Fractional Diffusion Equation in Two Dimensions</a> by Q. Yang et al, but adopts a more efficient implementation similar to that in the <a class="elRef" href="../../dg/html/classdg_1_1_p_c_g.html">PCG</a> method. Further also the conventional Lanczos method can be found there and also in text books such as <a href="https://www-users.cs.umn.edu/~saad/IterMethBook_2ndEd.pdf">Iteratvie Methods for Sparse Linear Systems 2nd edition by Yousef Saad</a>.</p>
<dl class="section note"><dt>Note</dt><dd>We have two stopping criteria. The <b>residual</b> criterion stops when \( \tau ||r_i||_W = \tau ||\vec b||_W \beta_i (T^{-1})_{1m} \leq \epsilon_{rel} ||\vec b||_W + \epsilon_{aps} \) where \( \tau \) is a residual factor accounting for the condition of various matrix functions</dd>
<dd>
The <b>universal</b> stopping criterion is based on the paper <a href="https://doi.org/10.1007/s10444-021-09882-7">Estimating the error in matrix function approximations</a> by Q. Eshghi, N. and Reichel L., The iteration stops when   <p class="formulaDsp">
\[
||\vec{e}_{f,m}||_W = ||\vec{b}||_W ||\left(\check{T} - f(\bar{T})\right)\vec{e}_1||_2 \leq \epsilon_{rel} ||\vec{b}||_W ||f(T)\vec e_1||_2 + \epsilon_{abs}
\]
</p>
 with         <p class="formulaDsp">
\[
\bar{T} =
   \begin{pmatrix}
   T &amp; \beta_m \vec{e}_m &amp; &amp; \\
    \beta_m \vec{e}_m^T &amp;  \alpha_{m-1}  &amp; \beta_{m-2} &amp;  \\
    &amp; \beta_{m-2} &amp; \alpha_{m-2} &amp; \beta_{m-1-q} \\
    &amp; &amp; \beta_{n-1-q} &amp; \alpha_{n-q}
   \end{pmatrix}
\]
</p>
       <p class="formulaDsp">
\[
   \check{T} =
   \begin{pmatrix}
   f(T) &amp; 0  \\
    0 &amp; 0
   \end{pmatrix}
\]
</p>
</dd></dl>
<p>The common Lanczos method (and M-Lanczos) method are prone to loss of orthogonality for finite precision. Here, only the basic Paige fix is used. Thus the iterations should be kept as small as possible. Could be fixed via full, partial or selective reorthogonalization strategies, but so far no problems occured due to this.  </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">ContainerType</td><td>Any class for which a specialization of <code><a class="elRef" href="../../dg/html/structdg_1_1_tensor_traits.html">TensorTraits</a></code> exists and which fulfills the requirements of the there defined data and execution policies derived from <code><a class="elRef" href="../../dg/html/structdg_1_1_any_vector_tag.html">AnyVectorTag</a></code> and <code><a class="elRef" href="../../dg/html/structdg_1_1_any_policy_tag.html">AnyPolicyTag</a></code>. Among others<ul>
<li><code> <a class="elRef" href="../../dg/html/group__typedefs.html#gae96159fd82ffccb3e43d361798b9b1ef">dg::HVec</a> (serial), <a class="elRef" href="../../dg/html/group__typedefs.html#ga8a6aa043869775ccdd104ec76c203eab">dg::DVec</a> (cuda / omp), <a class="elRef" href="../../dg/html/group__typedefs.html#ga85537b3f4c765fc2fb64542f9e921c8a">dg::MHVec</a> (mpi + serial) or <a class="elRef" href="../../dg/html/group__typedefs.html#ga51c318aff99dd51d76cd666818ce5b56">dg::MDVec</a> (mpi + cuda / omp) </code></li>
<li><code> std::vector&lt;dg::DVec&gt; </code> (vector of shared device vectors), <code> std::array&lt;double, 4&gt; </code> (array of 4 doubles) or <code> std::map &lt; std::string, <a class="elRef" href="../../dg/html/group__typedefs.html#ga8a6aa043869775ccdd104ec76c203eab">dg::DVec</a>&gt; </code> ( a map of named vectors)</li>
<li><code> double (scalar)</code> and other primitive types ...</li>
</ul>
If there are several <code>ContainerTypes</code> in the argument list, then <code><a class="elRef" href="../../dg/html/structdg_1_1_tensor_traits.html">TensorTraits</a></code> must exist for all of them </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>See <a class="elRef" href="../../dg/html/group__dispatch.html#dispatch">The dg dispatch system</a> for a detailed explanation of our type dispatch system    </dd></dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a370305216d927c1cbffcfe8fe58ae685" name="a370305216d927c1cbffcfe8fe58ae685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a370305216d927c1cbffcfe8fe58ae685">&#9670;&#160;</a></span>value_type</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;<a class="el" href="tridiaginv__b_8cpp.html#a099c90519d34c2dbab58e4a771aa6f25">::value_type</a> = <a class="elRef" href="../../dg/html/group__dispatch.html#gafb37680870fa007f5c17589781880e92">get_value_type</a>&lt;ContainerType&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>value type of the ContainerType class </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa044680e0ff1a7be7528235965c58363" name="aa044680e0ff1a7be7528235965c58363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa044680e0ff1a7be7528235965c58363">&#9670;&#160;</a></span>UniversalLanczos() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::UniversalLanczos </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate nothing, Call <code>construct</code> method before usage. </p>

</div>
</div>
<a id="a75567bfd54a7f388d3abe111ea25554c" name="a75567bfd54a7f388d3abe111ea25554c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75567bfd54a7f388d3abe111ea25554c">&#9670;&#160;</a></span>UniversalLanczos() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::UniversalLanczos </td>
          <td>(</td>
          <td class="paramtype">const ContainerType &amp;</td>          <td class="paramname"><span class="paramname"><em>copyable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>max_iterations</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate memory for the method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">copyable</td><td>A ContainerType must be copy-constructible from this </td></tr>
    <tr><td class="paramname">max_iterations</td><td>Maximum number of iterations to be used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aeb5ed88c774c43d92c8c9a42cf9a755e" name="aeb5ed88c774c43d92c8c9a42cf9a755e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb5ed88c774c43d92c8c9a42cf9a755e">&#9670;&#160;</a></span>construct()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<div class="memtemplate">
template&lt;class ... Params&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::construct </td>
          <td>(</td>
          <td class="paramtype">Params &amp;&amp;...</td>          <td class="paramname"><span class="paramname"><em>ps</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perfect forward parameters to one of the constructors.    </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Params</td><td>deduced by the compiler </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ps</td><td>parameters forwarded to constructors    </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2a2911d91ba236e25a10c9e01dff5bc1" name="a2a2911d91ba236e25a10c9e01dff5bc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a2911d91ba236e25a10c9e01dff5bc1">&#9670;&#160;</a></span>get_bnorm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::get_bnorm </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Norm of <code>b</code> from last call to <code>operator()</code> </p>
<dl class="section return"><dt>Returns</dt><dd>bnorm </dd></dl>

</div>
</div>
<a id="a9911ecaf6fd13d1d4b7bcdf1691af335" name="a9911ecaf6fd13d1d4b7bcdf1691af335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9911ecaf6fd13d1d4b7bcdf1691af335">&#9670;&#160;</a></span>get_iter()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::get_iter </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the number of iterations in the last call to <code>tridiag</code> or <code>solve</code> (same as T.num_rows) </p>
<dl class="section return"><dt>Returns</dt><dd>the number of iterations in the last call to <code>tridiag</code> or <code>solve</code> </dd></dl>

</div>
</div>
<a id="a8c3263e23586f66cb758f8bbc94c3e44" name="a8c3263e23586f66cb758f8bbc94c3e44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c3263e23586f66cb758f8bbc94c3e44">&#9670;&#160;</a></span>get_max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::get_max </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the current maximum number of iterations. </p>
<dl class="section return"><dt>Returns</dt><dd>the current maximum </dd></dl>

</div>
</div>
<a id="a5eec63212c438fbd0f3187a934c7948c" name="a5eec63212c438fbd0f3187a934c7948c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eec63212c438fbd0f3187a934c7948c">&#9670;&#160;</a></span>normMbVy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<div class="memtemplate">
template&lt;class MatrixType , class ContainerType0 , class ContainerType1 , class ContainerType2 &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::normMbVy </td>
          <td>(</td>
          <td class="paramtype">MatrixType &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../../dg/html/structdg_1_1_tri_diagonal.html">dg::TriDiagonal</a>&lt; thrust::host_vector&lt; <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType0 &amp;</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ContainerType1 &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType2 &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>bnorm</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>compute \( x = |b|_W V y \) from a given tridiagonal matrix T and in-place re-computation of V </p>
<p>We avoid explicit storage of the large matrix V </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>A self-adjoint positive definit matrix </td></tr>
    <tr><td class="paramname">T</td><td>Tridiagonal matrix </td></tr>
    <tr><td class="paramname">y</td><td>a (host) vector e.g y= T e_1 or y= f(T) e_1, must have size of <code>T.num_rows</code> </td></tr>
    <tr><td class="paramname">x</td><td>The result vector (output) </td></tr>
    <tr><td class="paramname">b</td><td>Contains the initial value of lanczos method </td></tr>
    <tr><td class="paramname">bnorm</td><td>the norm of b in weights, <code><a class="el" href="#a2a2911d91ba236e25a10c9e01dff5bc1" title="Norm of b from last call to operator()">get_bnorm()</a></code> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad367aeffd08562f5e557b633f51e7339" name="ad367aeffd08562f5e557b633f51e7339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad367aeffd08562f5e557b633f51e7339">&#9670;&#160;</a></span>set_max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::set_max </td>
          <td>(</td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>new_max</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the maximum number of iterations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_max</td><td>New maximum number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7a4938f6a1f1d7a73852f7ba46a7dba8" name="a7a4938f6a1f1d7a73852f7ba46a7dba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4938f6a1f1d7a73852f7ba46a7dba8">&#9670;&#160;</a></span>set_verbose()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::set_verbose </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>verbose</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set or unset debugging output during iterations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verbose</td><td>If true, additional output will be written to <code>std::cout</code> during solution </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aac8263710136f1baa907c32179d2ad60" name="aac8263710136f1baa907c32179d2ad60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac8263710136f1baa907c32179d2ad60">&#9670;&#160;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<div class="memtemplate">
template&lt;class MatrixType , class ContainerType0 , class ContainerType1 , class ContainerType2 , class FuncTe1 &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::solve </td>
          <td>(</td>
          <td class="paramtype">ContainerType0 &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FuncTe1</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType1 &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType2 &amp;</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>eps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>nrmb_correction</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1.</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>error_norm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;universal&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>res_fac</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1.</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>q</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>\( x = f(A)b \approx ||b||_W V f(T) e_1 \) via Lanczos and matrix function computation. A is self-adjoint in the weights \( W\). </p>
<p>Tridiagonalize \(A\) using Lanczos algorithm with a residual or universal stopping criterion</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>output vector </td></tr>
    <tr><td class="paramname">f</td><td>the matrix function that is called like <code>yH</code> = f( T) where T is the tridiagonal matrix and returns the result of \( f(T)\vec e_1\) (for example <code>dg::mat::make_FuncEigen_Te1( dg::SQRT&lt;double&gt;())</code> ) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__matrixfunctionapproximation.html">Matrix-functions</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>self-adjoint and semi-positive definit matrix </td></tr>
    <tr><td class="paramname">b</td><td>input vector </td></tr>
    <tr><td class="paramname">weights</td><td>weights in which A is self-adjoint </td></tr>
    <tr><td class="paramname">eps</td><td>relative accuracy of M-Lanczos method </td></tr>
    <tr><td class="paramname">nrmb_correction</td><td>the absolute error in units of <code>eps</code> to be respected </td></tr>
    <tr><td class="paramname">error_norm</td><td>Either "residual" or "universal" </td></tr>
    <tr><td class="paramname">res_fac</td><td>factor \( \tau\) that is multiplied to the norm of the residual. Used to account for specific matrix function and operator in the convergence criterium </td></tr>
    <tr><td class="paramname">q</td><td>The q-number in the "universal stopping criterion</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of iterations of M-Lanczos routine </dd></dl>

</div>
</div>
<a id="a542904b98f6391e9c9d8aeed4d624047" name="a542904b98f6391e9c9d8aeed4d624047"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a542904b98f6391e9c9d8aeed4d624047">&#9670;&#160;</a></span>tridiag() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<div class="memtemplate">
template&lt;class MatrixType , class ContainerType0 , class ContainerType1 &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="elRef" href="../../dg/html/structdg_1_1_tri_diagonal.html">dg::TriDiagonal</a>&lt; thrust::host_vector&lt; <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> &gt; &gt; &amp; <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::tridiag </td>
          <td>(</td>
          <td class="paramtype">MatrixType &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType0 &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType1 &amp;</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>eps</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1e-12</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>nrmb_correction</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1.</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>error_norm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;universal&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>res_fac</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1.</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>q</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">@brief Tridiagonalization of A using Lanczos method with \f$ f(x) = x^{-1}\f$.

@note Just calls the general \c tridiag method with the function \f$ f(x) = x^{-1}\f$. Useful if one wants to compute the extreme Eigenvalues of \f$A\f$
</pre> <div class="fragment"><div class="line"><a class="code hl_class" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a> lanczos( A.weights(), 20);</div>
<div class="line"><span class="keyword">auto</span> T = lanczos.tridiag( A, A.weights(), A.weights());</div>
<div class="line"><span class="keyword">auto</span> EV = <a class="code hl_function" href="group__matrixinvert.html#ga007766053ae09dc8286d345e30838759">dg::mat::compute_extreme_EV</a>( T);</div>
<div class="line"><span class="comment">// EV[0] is the minimum, EV[1] the maximum Eigenvalue</span></div>
<div class="ttc" id="aclassdg_1_1mat_1_1_universal_lanczos_html"><div class="ttname"><a href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a></div><div class="ttdoc">Tridiagonalize  and approximate  via Lanczos algorithm. A is self-adjoint in the weights .</div><div class="ttdef"><b>Definition</b> lanczos.h:66</div></div>
<div class="ttc" id="agroup__matrixinvert_html_ga007766053ae09dc8286d345e30838759"><div class="ttname"><a href="group__matrixinvert.html#ga007766053ae09dc8286d345e30838759">dg::mat::compute_extreme_EV</a></div><div class="ttdeci">std::array&lt; value_type, 2 &gt; compute_extreme_EV(const dg::TriDiagonal&lt; thrust::host_vector&lt; value_type &gt; &gt; &amp;T)</div><div class="ttdoc">Compute extreme Eigenvalues of a symmetric tridiangular matrix.</div><div class="ttdef"><b>Definition</b> tridiaginv.h:675</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a361b5dcad0b7e2f96b408be1eaa5499b" name="a361b5dcad0b7e2f96b408be1eaa5499b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a361b5dcad0b7e2f96b408be1eaa5499b">&#9670;&#160;</a></span>tridiag() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<div class="memtemplate">
template&lt;class UnaryOp , class MatrixType , class ContainerType1 , class ContainerType2 &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="elRef" href="../../dg/html/structdg_1_1_tri_diagonal.html">dg::TriDiagonal</a>&lt; thrust::host_vector&lt; <a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a> &gt; &gt; &amp; <a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">dg::mat::UniversalLanczos</a>&lt; ContainerType &gt;::tridiag </td>
          <td>(</td>
          <td class="paramtype">UnaryOp</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType1 &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType2 &amp;</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>eps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>nrmb_correction</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>error_norm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;residual&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a370305216d927c1cbffcfe8fe58ae685">value_type</a></td>          <td class="paramname"><span class="paramname"><em>res_fac</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1.</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>q</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tridiagonalization of A using Lanczos method. </p>
<p>Tridiagonalize \(A\) using Lanczos algorithm with a residual or universal stopping criterion on the function \( f(x) \) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Unary function </td></tr>
    <tr><td class="paramname">A</td><td>A self-adjoint, positive definit matrix </td></tr>
    <tr><td class="paramname">b</td><td>The initial vector that starts orthogonalization </td></tr>
    <tr><td class="paramname">weights</td><td>Weights that define the scalar product in which <code>A</code> is self-adjoint and in which the error norm is computed. </td></tr>
    <tr><td class="paramname">eps</td><td>relative accuracy of residual </td></tr>
    <tr><td class="paramname">nrmb_correction</td><td>the absolute error <code>C</code> in units of <code>eps</code> to be respected </td></tr>
    <tr><td class="paramname">error_norm</td><td>Either "residual" or "universal" </td></tr>
    <tr><td class="paramname">res_fac</td><td>factor \( \tau\) that is multiplied to the norm of the residual. Used to account for specific matrix function and operator in the convergence criterium </td></tr>
    <tr><td class="paramname">q</td><td>The q-number in the "universal stopping criterion</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>returns the tridiagonal matrix T. Note that \( T = (MV)^T A V \). The number of iterations is given by <code>T.num_rows</code> </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="lanczos_8h_source.html">lanczos.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedg.html">dg</a></li><li class="navelem"><a class="el" href="namespacedg_1_1mat.html">mat</a></li><li class="navelem"><a class="el" href="classdg_1_1mat_1_1_universal_lanczos.html">UniversalLanczos</a></li>
    <li class="footer">Generated on Mon Jun 23 2025 12:36:41 for Extension: Matrix functions by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
